{"version":3,"sources":["settings.js","help.js","draw.js","game.js","store.js","bezel.js","index.js"],"names":["log","ulog","Settings","Area","Row","Title","Object","keys","kanji","map","k","Button","role","key","onClick","info","styled","div","Help","shown","show","useState","Heading","Content","Canvas","ref","useRef","down","event","st","drawing","debug","up","useLayoutEffect","canvas","current","move","e","movezz","r","getBoundingClientRect","scale","width","addEventListener","removeEventListener","Canvase","height","x","y","touches","t","pageX","target","offsetLeft","pageY","offsetTop","offsetX","offsetY","ctx","getContext","fillStyle","fillRect","Game","editing","useSelector","state","game","bar","Info","Array","_","i","Cell","id","Glass","Zoom","value","tiles","dispatch","useDispatch","editable","length","edit","type","Nib","src","alt","tools","window","__REDUX_DEVTOOLS_EXTENSION__","settings","action","produce","draft","xx","GAME_INITIAL","undefined","data","createStore","combineReducers","Bezel","store","Frame","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"0+rEAKA,MAAMA,EAAMC,IAAK,YAmBFC,MAjBE,IACR,kBAACC,EAAD,KACL,kBAACC,EAAD,KACE,kBAACC,EAAD,qBACEC,OAAOC,KAAKC,GAAOC,IAAIC,GACvB,kBAACC,EAAD,CAAQC,KAAK,SAASC,IAAKH,EAAGI,QAAS,IAAMd,EAAIe,KAAKL,IAAKA,KAG/D,kBAACN,EAAD,KACE,kBAACC,EAAD,2BACE,CAAC,OAAQ,SAAU,QAAQI,IAAIC,GAC/B,kBAACC,EAAD,CAAQC,KAAK,SAASC,IAAKH,EAAGI,QAAS,IAAMd,EAAIe,KAAKL,IAAKA,MAQnE,MAAMP,EAAOa,IAAOC,IAAV,qEAAGD,CAAH,gFAOJZ,EAAMY,IAAOC,IAAV,oEAAGD,CAAH,qGAOHX,EAAQW,IAAOC,IAAV,sEAAGD,CAAH,gBAILL,EAASK,IAAOC,IAAV,uEAAGD,CAAH,oJC/BGE,MAVF,KACX,MAAOC,EAAOC,GAAQC,oBAAS,GAC/B,OAAO,kBAAC,EAAD,KACL,kBAACC,EAAD,CAASR,QAAS,IAAMM,GAAMD,IAA9B,OAEGA,EAAM,kBAACI,EAAD,gBAA2B,QAOxC,MAAMpB,EAAOa,IAAOC,IAAV,gEAAGD,CAAH,2DAMJM,EAAUN,IAAOC,IAAV,mEAAGD,CAAH,wBAIPO,EAAUP,IAAOC,IAAV,mEAAGD,CAAH,4G,YCrBb,MAAMhB,EAAMC,IAAK,QA4CFuB,MAzCA,KACb,MAAMC,EAAMC,mBAENC,EAAOC,IACXC,EAAGC,SAAU,EAGb9B,EAAI+B,MAAMH,IAENI,EAAKJ,IACTC,EAAGC,SAAU,EACb9B,EAAI+B,MAAM,KAAMH,IA2BlB,OAxBAK,0BAAgB,KACd,MAAMC,EAAST,EAAIU,QACbC,EAAOC,GAAKC,EAAOD,EAAGZ,GACtBc,EAAIL,EAAOM,wBASjB,OARAX,EAAGY,MApBM,IAoBSF,EAAEG,MACpBR,EAAOS,iBAAiB,aAAchB,GACtCO,EAAOS,iBAAiB,YAAaP,GACrCF,EAAOS,iBAAiB,WAAYX,GACpCE,EAAOS,iBAAiB,YAAahB,GACrCO,EAAOS,iBAAiB,YAAaP,GACrCF,EAAOS,iBAAiB,UAAWX,GAE5B,KACDE,IACFA,EAAOU,oBAAoB,aAAcjB,GACzCO,EAAOU,oBAAoB,YAAaR,GACxCF,EAAOU,oBAAoB,WAAYZ,GACvCE,EAAOU,oBAAoB,YAAajB,GACxCO,EAAOU,oBAAoB,YAAaR,GACxCF,EAAOU,oBAAoB,UAAWZ,IAExCH,EAAGC,SAAU,IAEd,CAACL,IACG,kBAACoB,EAAD,CAASH,MAxCL,IAwCkBI,OAxClB,IAwCgCrB,IAAKA,KAKlD,MAAMa,EAAS,CAACV,EAAOH,KACrB,GAAII,EAAGC,QAAS,CACd,IAAIiB,EAAGC,EACP,GAAIpB,EAAMqB,QAAS,CACjB,MAAMC,EAAItB,EAAMqB,QAAQ,GACxBF,GAAKG,EAAEC,MAAQD,EAAEE,OAAOC,YAAcxB,EAAGY,MACzCO,GAAKE,EAAEI,MAAQJ,EAAEE,OAAOG,WAAa1B,EAAGY,WAGxCM,EAAInB,EAAM4B,QAAU3B,EAAGY,MACvBO,EAAIpB,EAAM6B,QAAU5B,EAAGY,MAEzB,MACMiB,EADSjC,EAAIU,QACAwB,WAAW,MAC9BD,EAAIE,UAAY,QAChBF,EAAIG,SAASd,EAAGC,EAAG,EAAG,GACtBnB,EAAGkB,EAAIA,EACPlB,EAAGmB,EAAIA,IAKLnB,EAAK,CACTC,SAAS,EACTiB,EAAG,EACHC,EAAG,EACHP,MAAO,GAGHI,EAAU7B,IAAOkB,OAAV,gEAAGlB,CAAH,iCCrEDf,IAAK,QAgBF6D,MAdF,KACX,MAAMC,EAAUC,YAAYC,GAASA,EAAMC,KAAKC,KAIhD,OAAO,oCACL,kBAACC,EAAD,aADK,IAEL,kBAAC,EAAD,KACG,IAAI,IAAIC,MAAM,KAAM5D,IAAI,CAAC6D,EAAGC,IAAM,kBAACC,EAAD,CAAM3D,IAAK0D,EAAGE,GAAIF,KACpDR,EAAQ,kBAACW,EAAD,KAAO,kBAACC,EAAD,KAAM,kBAAC,EAAD,QAAyB,QAOrD,MAAMH,EAAO,EAAEC,SAGb,MAAMG,EAAQZ,YAAYC,GAASA,EAAMC,KAAKW,MAAMJ,IAC9CK,EAAWC,cACXC,GAAYJ,GAASA,EAAMK,OAAS,EACpCC,EAAOF,GAAQ,KAAWF,EAAS,CAACK,KAAM,YAAaV,QAC7D,OAAO,kBAACW,EAAD,CAAKtE,QAASoE,GAAOF,EAAS,yBAAKK,IAAKT,EAAOU,IAAI,KAAKV,IAK3DR,EAAOpD,IAAOC,IAAV,6DAAGD,CAAH,sBAIJb,EAAOa,IAAOC,IAAV,6DAAGD,CAAH,yHAQJoE,EAAMpE,IAAOC,IAAV,4DAAGD,CAAH,oaAcH0D,EAAQ1D,IAAOC,IAAV,8DAAGD,CAAH,sHAUL2D,EAAO3D,IAAOC,IAAV,6DAAGD,CAAH,wK,uBCxEV,MAAMhB,EAAMC,IAAK,SAEXsF,EAAK,UAAGC,cAAH,iBAAG,EAAQC,oCAAX,aAAG,UAERC,EAAW,CAACzB,EAAM,GAAI0B,IAAWC,YAAQ3B,EAAO4B,IAEpD,OADA7F,EAAI+B,MAAM4D,GACFA,GACR,IAAK,SAEH,YADAE,EAAMC,GAAK,IAEb,QACE,UAIEC,EAAe,CACnBhC,aAASiC,EACTnB,MAAO,IAAI,IAAIR,MAAM,MAGjBH,EAAO,CAACD,EAAM8B,EAAcJ,IAAWC,YAAQ3B,EAAO4B,IAC1D,OAAQF,GACR,IAAK,YAEH,YADAE,EAAM9B,QAAU4B,EAAOlB,IAEzB,IAAK,iBAEH,YADAoB,EAAMhB,MAAMc,EAAOlB,IAAMkB,EAAOM,MAElC,QACE,UASWC,kBALE,CAACjC,EAAO0B,IAAWQ,YAAgB,CAClDT,SADkD,EAElDxB,KAFkD,GAAhBiC,CAGjClC,EAAO0B,GAE2BJ,GCtBtBa,MAXD,IACL,kBAAC,IAAD,CAAUC,MAAOA,GACtB,kBAACC,EAAD,KACE,kBAAC,IAAD,MACA,kBAAC,EAAD,MACA,kBAAC,EAAD,MACA,kBAAC,EAAD,QAON,MAAMA,EAAQtF,IAAOC,IAAV,kEAAGD,CAAH,yCClBXuF,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,U","file":"static/js/main.1c4845eb.chunk.js","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components/macro\";\nimport {filename} from \"paths.macro\";\nimport ulog from \"ulog\";\nimport kanji from \"kanji.json\";\nconst log = ulog(filename);  // eslint-disable-line no-unused-vars\n\nconst Settings = () => {\n  return <Area>\n    <Row>\n      <Title>Kanji grade:</Title>\n      { Object.keys(kanji).map(k => \n        <Button role=\"button\" key={k} onClick={() => log.info(k)}>{k}</Button>)\n      }\n    </Row>\n    <Row>\n      <Title>Sudoku difficulty:</Title>\n      { [\"easy\", \"medium\", \"hard\"].map(k =>\n        <Button role=\"button\" key={k} onClick={() => log.info(k)}>{k}</Button>)\n      }\n    </Row>\n  </Area>;\n};\n\nexport default Settings;\n\nconst Area = styled.div`\n  flex: 0 0 10vmin;\n  outline: 1px dashed red;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Row = styled.div`\n  flex: none;\n  display: flex;\n  &:first-child{ border-top: 1px solid black; }\n  border-bottom: 1px solid black;\n`;\n\nconst Title = styled.div`\n  flex: auto;\n`;\n\nconst Button = styled.div`\n  box-sizing: border-box;\n  padding: 0 .25em;\n  border-left: 1px solid black;\n  border-right: none;\n  cursor: pointer;\n  &:hover {\n    background-color: rgba(255,0,0,.1);\n  }\n`;\n","import React, {useState} from \"react\";\nimport styled from \"styled-components/macro\";\n\nconst Help = () => {\n  const [shown, show] = useState(false);\n  return <Area>\n    <Heading onClick={() => show(!shown)}>\n      Help\n      {shown?<Content>content</Content>:null}\n    </Heading>\n  </Area>;\n};\n\nexport default Help;\n\nconst Area = styled.div`\n  flex: 0 0 3vmin;\n  outline: 1px dashed green;\n  display: flex;\n`;\n\nconst Heading = styled.div`\n  position: relative;\n`;\n\nconst Content = styled.div`\n  position: absolute;\n  top: 3vmin;\n  left: 0;\n  width: 100vw;\n  height: 30vmin;\n  background: white;\n  outline: 1px dashed blue;\n`;\n","import React, {useRef, useLayoutEffect} from \"react\";\nimport styled from \"styled-components/macro\";\nimport {filename} from \"paths.macro\";\nimport ulog from \"ulog\";\nconst log = ulog(filename);  // eslint-disable-line no-unused-vars\nconst SIZE = 1000;\n\nconst Canvas = () => {\n  const ref = useRef();\n\n  const down = event => {\n    st.drawing = true;\n    //st.x = event.offsetX * st.scale;\n    //st.y = event.offsetY * st.scale;\n    log.debug(event);\n  };\n  const up = event => {\n    st.drawing = false;\n    log.debug(\"up\", event);\n  };\n\n  useLayoutEffect(() => {\n    const canvas = ref.current;\n    const move = e => movezz(e, ref);\n    const r = canvas.getBoundingClientRect();\n    st.scale = SIZE / r.width;\n    canvas.addEventListener(\"touchstart\", down);\n    canvas.addEventListener(\"touchmove\", move);\n    canvas.addEventListener(\"touchend\", up);\n    canvas.addEventListener(\"mousedown\", down);\n    canvas.addEventListener(\"mousemove\", move);\n    canvas.addEventListener(\"mouseup\", up);\n\n    return () => {\n      if (canvas) {\n        canvas.removeEventListener(\"touchstart\", down);\n        canvas.removeEventListener(\"touchmove\", move);\n        canvas.removeEventListener(\"touchend\", up);\n        canvas.removeEventListener(\"mousedown\", down);\n        canvas.removeEventListener(\"mousemove\", move);\n        canvas.removeEventListener(\"mouseup\", up);\n      }\n      st.drawing = false;\n    };\n  }, [ref]);\n  return <Canvase width={SIZE} height={SIZE} ref={ref}/>;\n};\n\nexport default Canvas;\n\nconst movezz = (event, ref) => {\n  if (st.drawing) {\n    let x, y;\n    if (event.touches) {\n      const t = event.touches[0];\n      x = (t.pageX - t.target.offsetLeft) * st.scale;\n      y = (t.pageY - t.target.offsetTop) * st.scale;\n    }\n    else {\n      x = event.offsetX * st.scale;\n      y = event.offsetY * st.scale;\n    }\n    const canvas = ref.current;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.fillStyle = \"green\";\n    ctx.fillRect(x, y, 3, 3);\n    st.x = x;\n    st.y = y;\n  }\n};\n\n\nconst st = {\n  drawing: false,\n  x: 0,\n  y: 0,\n  scale: 1,\n};\n\nconst Canvase = styled.canvas`\n  flex: auto;\n  cursor: crosshair;\n`;\n","import React from \"react\";\nimport {useSelector, useDispatch} from \"react-redux\";\nimport styled from \"styled-components/macro\";\nimport PropTypes from \"prop-types\";\nimport {filename} from \"paths.macro\";\nimport ulog from \"ulog\";\nimport reading from \"reading.json\";\nimport easy from \"easy.json\";\nimport kanji from \"kanji.json\";\nimport Canvas from \"draw\";\nconst log = ulog(filename);  // eslint-disable-line no-unused-vars\n\nconst Game = () => {\n  const editing = useSelector(state => state.game.bar);\n  void(reading);\n  void(easy);\n  void(kanji);\n  return <>\n    <Info>info</Info>;\n    <Area>\n      {[...new Array(9*9)].map((_, i) => <Cell key={i} id={i}/>)}\n      {editing?<Glass><Zoom><Canvas/></Zoom></Glass>:null}\n    </Area>\n  </>;\n};\n\nexport default Game;\n\nconst Cell = ({id}) => {\n  // Either a single Kanji (prefilled cell, selected by computer),\n  // or a data URI (empty cell edited by user) or undefined (not edited)\n  const value = useSelector(state => state.game.tiles[id]);\n  const dispatch = useDispatch();\n  const editable = !value || value.length > 1;\n  const edit = editable && (() => dispatch({type: \"GAME.EDIT\", id}));\n  return <Nib onClick={edit}>{editable?<img src={value} alt=\"\"/>:value}</Nib>;\n};\n\nCell.propTypes = {id: PropTypes.number.isRequired};\n\nconst Info = styled.div`\n  flex: 0 0 40vmin;\n`;\n\nconst Area = styled.div`\n  position: relative;\n  flex: 0 0 100vmin;\n  outline: 1px dashed orange;\n  display: grid;\n  grid: repeat(9, 10vmin) / auto-flow 10vmin;\n`;\n\nconst Nib = styled.div`\n  text-align: center;\n  line-height: 10vmin;\n  box-sizing: border-box;\n  border-top: 0.3vmin solid rgba(0,0,0,.3);\n  border-left: 0.3vmin solid rgba(0,0,0,.3);\n  &:nth-child(9n) { border-bottom: 0.3vmin solid black; }\n  &:nth-child(n+73) { border-right: 0.3vmin solid black; }\n  &:nth-child(3n+1) { border-top: 0.3vmin solid black; }\n  &:nth-child(-n+9),\n  &:nth-child(n+28):nth-child(-n+36),\n  &:nth-child(n+55):nth-child(-n+63) { border-left: 0.3vmin solid black; }\n`;\n\nconst Glass = styled.div`\n  position: absolute;\n  top: 0;\n  width: 90vmin;\n  height: 90vmin;\n  backdrop-filter: blur(1px);  /* except firefox :( */\n  box-sizing: border-box;\n  display: flex;\n`;\n\nconst Zoom = styled.div`\n  margin: auto;\n  height: 60vmin;\n  width: 60vmin;\n  background-color: white;\n  box-sizing: border-box;\n  box-shadow: #aaa 0 0 10vmin;\n  border-radius: 0.5vmin;\n  padding: 0.5vmin;\n  display: flex;\n`;\n","import {createStore, combineReducers} from \"redux\";\nimport {produce} from \"immer\";\nimport {filename} from \"paths.macro\";\nimport ulog from \"ulog\";\nconst log = ulog(filename);\n\nconst tools = window?.__REDUX_DEVTOOLS_EXTENSION__?.();\n\nconst settings = (state={}, action) => produce(state, draft => {\n  log.debug(action);\n  switch (action) {\n  case \"FOOBAR\":\n    draft.xx = 42;\n    return;\n  default:\n    return;\n  }\n});\n\nconst GAME_INITIAL = {\n  editing: undefined,\n  tiles: [...new Array(9*9)],  // either a single Kanji or a data URI\n};\n\nconst game = (state=GAME_INITIAL, action) => produce(state, draft => {\n  switch (action) {\n  case \"GAME.EDIT\":\n    draft.editing = action.id;\n    return;\n  case \"GAME.SAVE_TILE\":\n    draft.tiles[action.id] = action.data;\n    return;\n  default:\n    return;\n  }\n});\n\nconst reducers = (state, action) => combineReducers({\n  settings,\n  game,\n})(state, action);\n\nexport default createStore(reducers, tools);\n","import React from \"react\";\nimport {Provider} from \"react-redux\";\nimport {Reset} from \"styled-reset\";\nimport styled from \"styled-components/macro\";\nimport Settings from \"settings\";\nimport Help from \"help\";\nimport Game from \"game\";\nimport store from \"store\";\n\nconst Bezel = () => {\n  return <Provider store={store}>\n    <Frame>\n      <Reset/>\n      <Settings/>\n      <Help/>\n      <Game/>\n    </Frame>\n  </Provider>;\n};\n\nexport default Bezel;\n\nconst Frame = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Bezel from \"bezel\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Bezel/>\n  </React.StrictMode>,\n  document.getElementById(\"root\"));\n"],"sourceRoot":""}